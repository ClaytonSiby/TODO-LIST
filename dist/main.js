(()=>{"use strict";const e=e=>{const t=Date.now().toString();let a=[];return{id:t,name:e,tasks:a,addNewTask:e=>a.unshift(e)}},t=(e,t,a,n)=>({id:Date.now().toString(),title:e,dueDate:t,description:a,priority:n,complete:!1}),a=document.querySelector("[data-lists]"),n=document.querySelector("[data-new-list-form]"),l=document.querySelector("[data-new-list-input]"),i=document.querySelector("[data-delete-list-button]"),d=document.querySelector("[data-list-display-container]"),o=document.querySelector("[data-list-title]"),r=document.querySelector("[data-tasks]"),s=document.getElementById("task-template"),c=document.querySelector("[data-new-task-form]"),u=document.querySelector("[data-new-task-title]"),m=document.querySelector("[data-new-task-date]"),p=document.querySelector("[data-new-task-description]"),v=document.querySelector("[data-select-priority]"),y=document.querySelector("[data-clear-complete-tasks-button]"),f="task.lists",S="task.selectedListId";let k=JSON.parse(localStorage.getItem(f))||[],g=localStorage.getItem(S);function q(){localStorage.setItem(f,JSON.stringify(k)),localStorage.setItem(S,g),L()}function L(){E(a),k.forEach((e=>{const t=document.createElement("li");t.dataset.listId=e.id,t.classList.add("list-name"),t.innerText=e.name,e.id===g&&t.classList.add("active-list"),a.appendChild(t)}));const e=k.find((e=>e.id===g));null==g?d.style.display="none":(d.style.display="",o.innerText=e.name,E(r),function(e){e.tasks.forEach((e=>{if(null!=e.id){const t=document.importNode(s.content,!0),a=t.querySelector("input");a.id=e.id,a.checked=e.complete;const n=t.querySelector("label");n.htmlFor=e.id,n.append(e.name,", "),n.append(e.date,", "),n.append(e.description,", "),n.append(e.priority);const l=document.createElement("p");l.innerHTML="Edit",l.classList.add("edit"),l.addEventListener("click",(()=>function(e,t){u.value=e.name,m.value=e.date,v.value=e.priority,p.value=e.description,e.id=null,c.addEventListener("submit",(()=>{e.name=u.value,e.date=m.value,e.priority=v.value,e.description=p.value,t.innerHTML=`${e.name}, ${e.date}, ${e.description}, ${e.priority}`,q()}))}(e,n))),t.querySelector(".task").append(l),r.appendChild(t)}}))}(e))}function E(e){for(;e.firstChild;)e.removeChild(e.firstChild)}a.addEventListener("click",(e=>{"li"===e.target.tagName.toLowerCase()&&(g=e.target.dataset.listId,q())})),r.addEventListener("click",(e=>{"input"===e.target.tagName.toLowerCase()&&(k.find((e=>e.id===g)).tasks.find((t=>t.id===e.target.id)).complete=e.target.checked,q())})),y.addEventListener("click",(e=>{const t=k.find((e=>e.id===g));t.tasks=t.tasks.filter((e=>!e.complete)),q()})),i.addEventListener("click",(e=>{k=k.filter((e=>e.id!==g)),g=null,q()})),n.addEventListener("submit",(t=>{t.preventDefault();const a=l.value;if(null==a||""===a)return;const n=e(a);l.value=null,console.log(n.id),k.push(n),q()})),c.addEventListener("submit",(e=>{e.preventDefault();const a=u.value,n=m.value,l=p.value,i=v.value;if(!(a||n||l||i))return;t(a,n,l,i),u.value=null,m.value=null,p.value=null,v.value=null;const d=k.find((e=>e.id===g));console.log(d),q()})),L()})();