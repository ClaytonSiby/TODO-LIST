(()=>{const e=document.querySelector("[data-lists]"),t=document.querySelector("[data-new-list-form]"),a=document.querySelector("[data-new-list-input]"),n=document.querySelector("[data-delete-list-button]"),l=document.querySelector("[data-list-display-container]"),i=document.querySelector("[data-list-title]"),d=document.querySelector("[data-tasks]"),r=document.getElementById("task-template"),o=document.querySelector("[data-new-task-form]"),s=document.querySelector("[data-new-task-title]"),c=document.querySelector("[data-new-task-date]"),u=document.querySelector("[data-new-task-description]"),m=document.querySelector("[data-select-priority]"),p=document.querySelector("[data-clear-complete-tasks-button]"),v="task.lists",y="task.selectedListId";let f=JSON.parse(localStorage.getItem(v))||[],S=localStorage.getItem(y);function k(){localStorage.setItem(v,JSON.stringify(f)),localStorage.setItem(y,S),g()}function g(){q(e),f.forEach((t=>{const a=document.createElement("li");a.dataset.listId=t.id,a.classList.add("list-name"),a.innerText=t.name,t.id===S&&a.classList.add("active-list"),e.appendChild(a)}));const t=f.find((e=>e.id===S));null==S?l.style.display="none":(l.style.display="",i.innerText=t.name,q(d),function(e){e.tasks.forEach((e=>{if(null!=e.id){const t=document.importNode(r.content,!0),a=t.querySelector("input");a.id=e.id,a.checked=e.complete;const n=t.querySelector("label");n.htmlFor=e.id,n.append(e.name,", "),n.append(e.date,", "),n.append(e.description,", "),n.append(e.priority);const l=document.createElement("p");l.innerHTML="Edit",l.classList.add("edit"),l.addEventListener("click",(()=>function(e,t){s.value=e.name,c.value=e.date,m.value=e.priority,u.value=e.description,e.id=null,o.addEventListener("submit",(()=>{e.name=s.value,e.date=c.value,e.priority=m.value,e.description=u.value,t.innerHTML=`${e.name}, ${e.date}, ${e.description}, ${e.priority}`,k()}))}(e,n))),t.querySelector(".task").append(l),d.appendChild(t)}}))}(t))}function q(e){for(;e.firstChild;)e.removeChild(e.firstChild)}e.addEventListener("click",(e=>{"li"===e.target.tagName.toLowerCase()&&(S=e.target.dataset.listId,k())})),d.addEventListener("click",(e=>{"input"===e.target.tagName.toLowerCase()&&(f.find((e=>e.id===S)).tasks.find((t=>t.id===e.target.id)).complete=e.target.checked,k())})),p.addEventListener("click",(e=>{const t=f.find((e=>e.id===S));t.tasks=t.tasks.filter((e=>!e.complete)),k()})),n.addEventListener("click",(e=>{f=f.filter((e=>e.id!==S)),S=null,k()})),t.addEventListener("submit",(e=>{e.preventDefault();const t=a.value;if(null==t||""===t)return;const n={id:Date.now().toString(),name:a.value,tasks:[]};a.value=null,f.push(n),k()})),o.addEventListener("submit",(e=>{e.preventDefault();const t=s.value,a=c.value,n=u.value,l=m.value;if(!(t||a||n||l))return;const i={id:Date.now().toString(),name:s.value,date:c.value,priority:m.value,description:u.value,complete:!1};s.value=null,c.value=null,u.value=null,m.value=null,f.find((e=>e.id===S)).tasks.push(i),k()})),g()})();